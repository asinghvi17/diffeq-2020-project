\RequirePackage{luatex85}
\documentclass[%
 % reprint,
% superscriptaddress,
% groupedaddress,
% unsortedaddress,
% runinaddress,
% frontmatterverbose,
 preprint,
% preprintnumbers,
% nofootinbib,
% nobibnotes,
% bibnotes,
 amsmath,amssymb,
 aps,
 pra,
% prb,
% rmp,
% prstab,
% prstper,
% floatfix,
 fleqn,
]{revtex4-2}

\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{hyperref}% add hypertext capabilities
\usepackage{xcolor}
\usepackage{unicode-math}
\usepackage{fancyref}
\usepackage{siunitx}
\usepackage{soul}
\usepackage{nccmath}
\usepackage{tikz}

% \endofdump

\usetikzlibrary{calc, patterns, decorations.pathmorphing, decorations.markings}
\tikzset{
    ground/.style = {
        fill,
        pattern        = north east lines,
        draw           = none,
        minimum width  = 0.5cm,
        minimum height = 0.3cm,
    },
}

%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[showframe,%Uncomment any one of the following lines to test
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}

\usepackage[
    margin=1.2in,
    a4paper
]{geometry}

\expandafter\hypersetup{
  pdftitle = {Grungy Times: The Euler-Lagrange Equations},
  pdfauthor = {Anshul Singhvi},
  pdfdisplaydoctitle = true,
  colorlinks,
  linkcolor={red!50!black},
  citecolor={blue!50!black},
  urlcolor={blue!80!black}
}


\begin{document}

\preprint{APS/123-QED}

\title{Grungy Times: The Euler-Lagrange Equations}

\author{Anshul Singhvi}
\altaffiliation[Also at ]{Applied Physics Department, Columbia University.}
\email{asinghvi17@simons-rock.edu}
\author{Bethan Cordone}
\altaffiliation[Also at ]{Applied Physics Department, Columbia University.}
\email{bcordone17@simons-rock.edu}
\author{Prutha Patil}%
\email{ppatil18@simons-rock.edu}
\author{Yecheng Ma}
\altaffiliation[Also at ]{Operations Research Department, Columbia University.}
\email{yma17@simons-rock.edu}
\author{YuXuan Liu}
\altaffiliation[Also at ]{Applied Physics Department, Columbia University.}
\email{yliu17@simons-rock.edu}

\affiliation{Bard College at Simon's Rock}%

\date{\today}% It is always \today, today,
             %  but any date may be explicitly specified

\begin{abstract}
    The Euler-Lagrange equations are ewwler.  Here's what we can do to make them...kewwler.
\end{abstract}

\maketitle

\section{Introduction}
% https://www.youtube.com/watch?v=oHg5SJYRHA0, here's something fun for everyone.
Euler-Lagrange forms an integral part of our petrochemical production pipeline.

For systems with one degree of freedom, the \emph{action integral} called $J(y)$ can be expressed as:

\begin{equation}\label{eq: action}
    J(y) = \int_0^T F(t, y, \dot y) ~ dt
\end{equation}

\section{Falling Bodies} % q1

Any body falling sufficiently close to the surface of the Earth is subject to an approximately constant gravitational force $F = mg$, assuming a perfectly spherical Earth, and that the object's height above the surface of the Earth is much less than its radius.  Its trajectory is parameterized by a function $y(t)$ which expresses its height relative to the surface of the Earth.  We concern ourselves here with a trajectory going from $t = 0, y_0 = y(0)$ to $t = T, y = y(T)$.

The kinetic energy of a falling body is simply $\displaystyle T = \frac12 m\dot y^2$.  Its gravitational potential energy is the integral of the gravitational force from its origin to its destination; assuming the surface of the Earth as the origin ($y = 0$), $\displaystyle V = mgy$.

We have defined an isolated system; as such, in the confines of the system, there can be no change in the net amount of energy.  The energy can be represented $E_{tot} = T - V$, which expands to $\displaystyle E_{tot} = \frac12m\dot y(t)^2 - mgy(t)$.  This function $E_{tot}(t, y, \dot y)$ is what we need to conserve.

Thus, we can define the action integral $J$ as follows:
\[
    J = \int_0^T \frac12m\dot y(t)^2 - mgy(t) ~ dt
\]

By the Euler-Lagrange constraint, then,

\begin{align*}
  &\frac{∂}{∂y} \left[E_{tot}(t, y, \dot y)\right] - \frac{∂^2}{∂t∂y} \left[E_{tot}(t, y, \dot y)\right] = 0
\end{align*}

We can evaluate these partial derivatives, of course, and this evaluation gives us the equation:

\begin{align*}
  &m\ddot y(t) = -mg\\
  &⟹ \ddot y(t) = -g\\
\end{align*}

This can now be integrated with respect to time.

\begin{align*}
  &\iint \ddot y(t) ~ dt ~ dt = \iint -g ~ dt ~ dt\\
  &⟹ y(t) = \iint -g ~ dt ~ dt\\
  &⟹ y(t) = \int -gt + C_1 ~ dt\\
  &⟹ y(t) = -\frac12gt^2 + C_1t + C_2\\
\end{align*}

The constants $C_1$ and $C_2$ are really just the initial velocity and position of the object, respectively.  This function describes a parabolic trajectory, which we know to be true.

\section{The Brachistochrone Problem} % q3

The brachistochrone curve is simply the curve along which a frictionless particle will slide in the minimum time.  Brachistochrone trajectories are especially interesting in the context of space travel, since they provide the most efficient trajectories with which to traverse long distances.

The problem is, specifically, to find the curve $y(x)$ between points $y(a) = A$ and $y(b) = B$, along which a particle will slide in the minimum time.

Here, we will trace out Johann Bernoulli's solution to the brachistochrone problem, and justify all the steps he took.

We begin with the fundamental theorem of calculus, which shows that:
\[T = \int_0^t dt\]

Next, we proceed to a chain rule equality.  Though this is perhaps unpalatable to most mathematicians, it is trivial to show through the chain rule that $\frac{dt}{ds} ds = dt$:

\[\implies \int_0^T dt = \int_0^L \frac{dt}{ds} ds\]

However, there is an important simplification we can make here.  Velocity is defined as $v = \frac{ds}{dt}$, and a simple inversion shows that $\frac{dt}{ds} = \frac 1v$:

\[\int_0^L \frac{dt}{ds} ds = \int_0^L \frac 1v ~ ds\]

Let us assume a coordinate system in which the particle begins at the origin, and the positive $y$ direction points upwards, against the direction of gravity.  We can now find the velocity of the particle as a function of its position, by using the principle of energy conservation.

Additionally, let $h = 0$ be the initial position of the particle.  We know that the gravitational potential energy is simply $V_g = mgh$, and that the kinetic energy in the absence of rotation or friction is $T = \frac12 mv^2$.  Thus,

\begin{align*}
    &mgh = -mgy + \frac12 mv^2\\
    &\implies mgy = \frac12 mv^2\\
    &\implies v = \sqrt{2gy}
\end{align*}

Now, we can substitute this back into our original integral,

\[\int_0^L \frac 1v ~ ds = \int_0^L \frac{1}{\sqrt{2gy}} ~ ds\]

However, it's important to remember that here, $ds$ is actually just $\sqrt{dx^2 + dy^2}$.  This can then be algebraically simplified to $dx\sqrt{1 - \left(\frac{dy}{dx}\right)^2}$.  Substituting this into our integral,

\[\int_0^L \frac{1}{\sqrt{2gy}} ~ ds = \sqrt{\frac{1}{2g}} \int_a^b \sqrt{\frac{1 + y'^2}{y}} ~ dx\]

This is simply integrating over the $x$ domain of the path, as opposed to the $y$ domain.

We can now solve for the Euler-Lagrange equations of $\displaystyle \sqrt{\frac{1}{2g}} \int_a^b \sqrt{\frac{1 + y'^2}{y}} ~ dx$:

\begin{align*}
    &F_{y}=-\sqrt{\frac{1+(y')^2}{8 g}} y^{-\frac32}\\
    &F_{y^{\prime}}=\frac{y}{\sqrt{2 g y} \sqrt{1+(y')^2}}\\
    &F_{y^{\prime} x}=\frac{\frac{1}{2} y^{\prime 2}\left[y\left(1+y^{\prime 2}\right)\right]^{-1 / 2}\left(2 y^{\prime \prime} y+y^{\prime 2}+1\right)+y^{\prime \prime}(\sqrt{y} \sqrt{1+y^{\prime 2}})}{\sqrt{2 g y\left(1+y^{\prime 2}\right)}}
\end{align*}

We know that $F_{y'x} = F_y$.  Therefore, % TODO justify

\begin{align*}
    &\sqrt{\frac{1+y^{\prime 2}}{8 g}} y^{-\frac{3}{2}}-\frac{\frac{1}{2} y^{\prime 2}\left[y\left(1+y^{\prime 2}\right)\right]^{-1 / 2}\left(2 y^{\prime \prime} y+y^{\prime 2}+1\right)+y^{\prime \prime}(\sqrt{y} \sqrt{1+y^{\prime 2}})}{\sqrt{2 g y\left(1+y^{\prime 2}\right)}}=0\\
    &\text{After some tedious simplification, which is redacted for clarity,}\\
    &2y''y' + y'^2 + 1 = 0 & \Box
\end{align*}

\begin{figure}
    \includegraphics{brachistochrone.pdf}
    \caption{The brachistochrone trajectory from (0, 0) to (1, -0.65).  The dashed lines represent linear, slower paths.}
    \label{fig: brachistochrone}
\end{figure}

\section{The Spring-Mass System} % q2

\begin{figure}
    \centering
    \begin{tikzpicture}[every node/.style = {draw, outer sep = 0pt, thick}]
        \node (M) [minimum width=1cm, minimum height=2.5cm] {$m$};

        \node (ground) [ground,anchor=north,yshift=-0.25cm,minimum width=1.5cm] at (M.south) {};
        \draw (ground.north east) -- (ground.north west);
        \draw [thick] (M.south west) ++ (0.2cm,-0.125cm) circle (0.125cm)  (M.south east) ++ (-0.2cm,-0.125cm) circle (0.125cm);

        \node (wall) [ground, rotate=-90, minimum width=3cm,yshift=-3cm] {};
        \draw (wall.north east) -- (wall.north west);

        \draw [decorate, decoration = {coil, segment length=4pt}] (wall.east) ++ (0.15cm, 1.5cm) -- (M.west);

        \draw [-latex,ultra thick] (M.east) ++ (0.2cm,0) -- +(1cm,0) node [right] {$x$};

    \end{tikzpicture}
    \caption{A single-spring, single-mass system.}
\end{figure}

Spring-mass systems are very common in physics.  Let us define a system with a single mass, tethered to a wall by a spring.  Let it have a degree of freedom along the $x$-axis, and let the origin be at the equilibrium point.  Amen.

The elastic potential energy in this system is simply $\displaystyle V(x) = \frac12kx^2$, where $k$ is the constant of compressibility of the spring.  The formula for kinetic energy is unchanged ($\displaystyle T(\dot x) = \frac12m\dot x^2$).  Knowing these, the conserved term is $\displaystyle \mathscr L = T - V = \frac12m\dot x^2 - \frac12kx^2$.

From this, we can directly solve for the Euler-Lagrange equations:
\begin{align*}
  &\frac{∂\mathscr L}{∂x} = -kx\\
  &\frac{∂\mathscr L}{∂t∂x} = m\ddot x\\
  &⟹ m\ddot x + kx = 0\\
\end{align*}

This last expression is the differential equation which governs spring motion.  If we choose a mass of 1 kg, and a spring constant of

\section{Generalising the Lagrangian: Degrees of Freedom} % q6

\section{The Two Mass, Three Spring System} % q4

\section{The Ray Equation; Fermat's Principle} % q5

The velocity of an object in 2D can be broken down into its basis component, and the line element can be written in terms of velocity.
\[v = \sqrt{x'^2+y'^2}\qquad ds = vdt = \sqrt{x'^2+y'^2}dt\]

Then the total time taken can be calculated by
\[T = \int_P \frac{ds}{c(x,y)} = \int_P \frac{\sqrt{x'^2+y'^2}dt}{c(x,y)} = \int_PF(t,x,x',y,y')dt\]
\[text{ where }F(t,x,x',y,y') = \frac{\sqrt{x'^2+y'^2}}{c(x,y)}\]

To minimize time, the variation needs to be stationary at zero pertubation. $n_x$ and $n_y$ are small pertubations to the system.

\begin{ceqn}
    \begin{align*}
        \delta T &= \left.\frac{d T(t,x+\epsilon n_x, y+\epsilon n_y,x'+\epsilon n'_x,y'+\epsilon n'_y)}{d\epsilon}\right|_{\epsilon=0} = 0\\
        &= \int \left(\frac{\partial F}{\partial x}n_x + \frac{\partial F}{\partial x'}n_x' + \frac{\partial F}{\partial y}n_y + \frac{\partial F}{\partial y'}n_y'\right)\\
        &= \int \left(\frac{\partial F}{\partial x}n_x + \frac{\partial F}{\partial x'}\frac{d n_x}{dt} + \frac{\partial F}{\partial y}n_y + \frac{\partial F}{\partial y'}\frac{d n_y}{dt}\right)\\
        &= \int \left(\frac{\partial F}{\partial x}n_x - n_x\frac{d}{dt}\frac{\partial F}{\partial x'} + \frac{\partial F}{\partial y}n_y - n_y\frac{d}{dt}\frac{\partial F}{\partial y'}\right)\\
        &= \int \left(\left[\frac{\partial F}{\partial x} - \frac{d}{dt}\frac{\partial F}{\partial x'}\right]n_x + \left[\frac{\partial F}{\partial y} - \frac{d}{dt}\frac{\partial F}{\partial y'}\right]n_y\right)dt = 0\\
    \end{align*}
\end{ceqn}

Which can be summarized as a pair of lagrange equations
$$\frac{\partial F}{\partial x} = \frac{d}{d t}\frac{\partial F}{\partial x'} \qquad 1)$$
$$\frac{\partial F}{\partial y} = \frac{d}{d t}\frac{\partial F}{\partial y'}\qquad 2)$$

Carry out the derivation for equation 1(i.e. the x curve).
$$\frac{\partial F}{\partial x} = \sqrt{x'^2+y'^2}\frac{\partial}{\partial x}\frac{1}{c(x,y)} = -\frac{\sqrt{x'^2+y'^2}}{c(x,y)^2}\frac{\partial c(x,y)}{\partial x}$$

use the fact that $x' = \frac{dx}{dt}$
$$\frac{d}{d t} \frac{\partial F}{\partial x'} = \frac{d}{dt} \frac{\partial}{\partial x'}\frac{\sqrt{x'^2+y'^2}}{c(x,y)} = \frac{d}{dt} \frac{x'}{c(x,y)\sqrt{x'^2+y'^2}} = \frac{d}{dt} \frac{dx}{c(x,y)\sqrt{x'^2+y'^2}dt}$$

We can convert the independent variable form t to s by multiplying both side of equation 1 by $\frac{dt}{ds} = (x'^+y'^2)^{\frac{1}{2}}$:
$$\frac{\partial F}{\partial x}\frac{dt}{ds} = -(x'^+y'^2)^{\frac{1}{2}}\frac{\sqrt{x'^2+y'^2}}{c(x,y)^2}\frac{\partial c(x,y)}{\partial x} = -\frac{1}{c(x,y)^2}\frac{\partial c(x,y)}{\partial x}$$

Using chain rule and the fact that $ds = (x'^+y'^2)^{\frac{1}{2}} dt$:
$$\frac{d}{d t} \frac{\partial F}{\partial x'} \frac{dt}{ds} = \frac{dt}{ds}\frac{d}{dt} \frac{dx}{c(x,y)\sqrt{x'^2+y'^2}dt} = \frac{d}{ds}\frac{dx}{c(x,y)ds}$$.

The exact same procedure can be carry out on equation 2, which together would yield the following system:
$$\frac{d}{ds}\frac{1}{c(x,y)}\frac{dx}{ds} = -\frac{1}{c(x,y)^2}\frac{\partial c(x,y)}{\partial x}$$
$$\frac{d}{ds}\frac{1}{c(x,y)}\frac{dy}{ds} = -\frac{1}{c(x,y)^2}\frac{\partial c(x,y)}{\partial y}$$
\\

In fact, the system can be generalized into
$$\frac{d}{ds} \frac{1}{c(\vec{r})}\frac{d\vec{r}}{ds} = -\frac{1}{c(\vec{r})^2}\nabla c(\vec{r})$$
Where $\vec{r}$ is the position vector of the object and $\nabla$ is the gradient, and the expressioin describe a n-equation system component wise.\\

Taking $\vec{r} = (x,y)$ would yield the result derived above.\\

Let's consider ray propagation in a Gradient index (GRIN) medium such as the lens in our eye. Assume the medium is a cylinder shape, the speed of light (i.e. refractive index) varies based on distance from the central optical axis:
$$c = \frac{c_0}{a\sqrt{1-(cr)^2}}$$
where $r$ is radius in cylindrical coordinate, and $a,b$ are arbitrary constants, and $c_0$ is the speed of light in vacuum.

Choosing s = z (we are interested in the distance from the center as the ray propagate further into the cylinder, i.e. $r(z)$), the ray equation describes that:
\begin{ceqn}
    \begin{align*}
        \frac{d}{dz} \frac{a\sqrt{1-(cr)^2}}{c_0}\frac{d r}{dz} &= -\frac{a^2(1-(cr)^2)}{c_0^2}\nabla \frac{c_0}{a\sqrt{1-(cr)^2}}\\
        \frac{a\sqrt{1-(cr)^2}}{c_0}\frac{d^2 r}{dz^2} &= -\frac{a(1-(cr)^2)}{c_0}\frac{\partial}{\partial r} \frac{1}{\sqrt{1-(cr)^2}}\\
        \sqrt{1-(cr)^2}\frac{d^2 r}{dz^2} &= -(1-(cr)^2)\frac{\partial}{\partial r} \frac{1}{\sqrt{1-(cr)^2}}\\
        \frac{d^2 r}{dz^2} &= -\sqrt{1-(cr)^2} \frac{b^2r}{(1-(cr)^2)^{\frac{3}{2}}}\\
        \frac{d^2 r}{dz^2} &= -\frac{b^2r}{(1-(cr)^2)}\\
    \end{align*}
\end{ceqn}

This is a second order autonomous differential equation. We can simply the express by assuming $cr<<1$, the ODE then reduce to a simple \textit{second order linear homogeneous non-constant coefficient differential equation}, which we know the answer already:
\begin{ceqn}
    \begin{align*}
        \frac{d^2 r}{dz^2} &= -\frac{b^2r}{(1-(cr)^2)}\\
        &\approx -b^2 r\\
        \implies r(z) &= A\cos(cz)+B\sin(cz)
    \end{align*}
\end{ceqn}
Solving for the initial condition where the light enter at position $a$ with a slope of $b$
\begin{ceqn}
    \begin{align*}
        r(0) &= A\cos(c0)+B\sin(c0) = a \\
        &\implies A = a\\
        r'(0) &= -cA\sin(c0)+cB\cos(c0) = b \\
        &\implies B = \frac{b}{c}\\
        r(z) &= a\cos(cz)+\frac{b}{c}\sin(cz)
    \end{align*}
\end{ceqn}

The ray oscillates back and forth across the optical axis.

\end{document}
